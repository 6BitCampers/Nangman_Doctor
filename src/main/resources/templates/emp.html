<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

<div layout:fragment="content">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.0/dist/sweetalert2.all.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <style>
        /* Add the CSS styles here */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 1em;
            font-family: sans-serif;
            min-width: 400px;
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.1);
        }

        thead tr {
            background-color: #009879;
            color: #ffffff;
            text-align: left;
        }

        th, td {
            padding: 12px 15px;
        }

        tbody tr {
            border-bottom: 1px solid #dddddd;
        }

        tbody tr:nth-of-type(even) {
            background-color: #f3f3f3;
        }

        tbody tr:last-of-type {
            border-bottom: 2px solid #009879;
        }

        .accept-button, .reject-button {
            padding: 5px 10px;
            margin: 2px;
            color: white;
            background-color: green;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .submit-button{
            padding: 5px 10px;
            margin: 2px;
            color: white;
            background-color: green;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .reject-button {
            background-color: red;
        }

        .accept-button:hover, .reject-button:hover {
            opacity: 0.8;
        }
        .calendar-container {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            max-width: 600px;
            margin-bottom: 20px;
        }

        .calendar-header button {
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .calendar-header button:hover {
            background-color: #0056b3;
        }

        .calendar-table {
            width: 100%;
            max-width: 600px;
            border-collapse: collapse;
        }

        .calendar-table th, .calendar-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        .calendar-table th {
            background-color: #f4f4f4;
        }

        .calendar-table td:hover {
            background-color: #f1f1f1;
        }

        .video-call-button {
            padding: 5px 10px;
            margin-top: 5px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .video-call-button:hover {
            background-color: #218838;
        }
    </style>
    <div class="flex w-full">
        <div class="flex-1 bg-gray-100 p-8">
            <header class="flex items-center justify-between mb-8">
                <h1 class="text-2xl font-bold">Admin Dashboard</h1>
                <div class="flex items-center gap-4">
                    <button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10">
                        <svg
                                xmlns="http://www.w3.org/2000/svg"
                                width="24"
                                height="24"
                                viewBox="0 0 24 24"
                                fill="none"
                                stroke="currentColor"
                                stroke-width="2"
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                class="w-5 h-5"
                        >
                            <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9"></path>
                            <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0"></path>
                        </svg>
                        <span class="sr-only">Notifications</span>
                    </button>
                    <span class="relative flex shrink-0 overflow-hidden rounded-full w-8 h-8 border">
                        <img class="aspect-square h-full w-full" alt="Avatar" src="/placeholder-user.jpg"/>
                    </span>
                </div>
            </header>

            <div class="grid grid-cols-[300px_1fr_300px] gap-8 mx-auto py-10 px-4" style="display: flex; margin: 10px;">

                <div class="bg-background rounded-lg shadow-lg p-6" data-v0-t="card">
                    <div class="flex flex-col space-y-1.5 p-6">
                        <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">User List</h3>
                    </div>
                    <div class="p-6" style="height: 100%;">
                        <div class=" w-full overflow-auto">
                            <table class="w-full caption-bottom text-sm">
                                <thead class="[&amp;_tr]:border-b">
                                <tr class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        No
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0"
                                    style="width: 100px;">
                                        Name
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Email
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        HP
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Role
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Field
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        NickName
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        LikeCount
                                    </th>
                                    <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Actions
                                    </th>
                                    </th:block>
                                </tr>
                                </thead>
                                <tbody class="[&amp;_tr:last-child]:border-0">
                                <tr th:each="employeelist : ${emplist}" class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                                    <td th:text="${employeelist.employee_no}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_name}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_email}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_hp}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_role}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_field}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_nickname}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${employeelist.employee_likecount}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>

                                    <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                    <td class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0 flex items-center gap-2">
                                        <button data-bs-toggle="modal" data-bs-target="#myPageUpdateModal"  class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-10 w-10">

                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-4 h-4">
                                                <path d="M12 22h6a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v10"></path>
                                                <path d="M14 2v4a2 2 0 0 0 2 2h4"></path>
                                                <path d="M10.4 12.6a2 2 0 1 1 3 3L8 21l-4 1 1-4Z"></path>
                                            </svg>
                                            <span class="sr-only">Edit</span>

                                        </button>
                                    </td>
                                    </th:block>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal fade" id="myPageUpdateModal" tabindex="-1" aria-labelledby="myPageUpdateModalLabel" aria-hidden="true">
                <div class="modal-dialog modal-lg">
                    <div class="modal-content">
                            <div class="flex flex-col space-y-1.5 p-6">
                                <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">Register Hospital & Role</h3>
                                <p class="text-sm text-muted-foreground">Please register and identify the hospital you belong to and your role.</p>
                            </div>

                            <div class="p-6" >
                                <form action="/registerRole" method="post">

                                    <div class="grid gap-2" style="margin: 10px;">
                                        <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70">
                                            Name
                                        </label>

                                        <input
                                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                                placeholder="이름을 입력하세요"
                                                type="text"
                                        />

                                    </div>
                                    <div class="grid gap-2" style="margin: 10px;">
                                        <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70" for="email">
                                            Email
                                        </label>

                                        <input
                                                class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                                id="email"
                                                placeholder="nangman@examle.com"
                                                type="email" name="email"
                                        />
                                    </div>

                                    <div class="grid gap-2" style="margin: 10px;">
                                        <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                        >

                                            Role
                                        </label>
                                        <div class="flex items-center gap-2" style="width: 100%;">
                                            <select id="role" name="role" class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50">
                                                <option value="user">
                                                    User
                                                </option>
                                                <option value="ROLE_DOCTOR" >Doctor</option>
                                                <option value="ROLE_NURSE" >Nurse</option>
                                                <option value="ROLE_MANAGER">Manager</option>

                                                <span style="pointer-events: none;">User</span>

                                            </select>
                                            <button
                                                    class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 ml-2 bg-orange-600"
                                                    type="submit"
                                            >
                                                Register
                                            </button>
                                        </div>
                                    </div>
                                </form>
                                <form action="/registerName" method="post">
                                    <div class="grid gap-2" style="margin: 10px;">
                                        <label class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70">
                                            Hospital Name
                                        </label>
                                        <div class="flex items-center gap-2" style="width: 100%;">
                                            <input
                                                    id="hospitalSearchInput"
                                                    class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                                    placeholder="병원 이름 입력"
                                                    type="text"
                                                    onclick="openMappedUrl()"
                                            />

                                            <script>
                                                const mappedUrl = "/register"; // 여기에 매핑 주소를 입력하세요

                                                function openMappedUrl() {
                                                    // 새 창 열기
                                                    window.open(mappedUrl, '_blank');
                                                }
                                            </script>


                                            <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 ml-2 bg-orange-600">
                                                Register
                                            </button>
                                        </div>
                                    </div>

                                </form>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div class="grid gap-8" style="display: flex; margin: 10px;">
                <div class="bg-background rounded-lg shadow-lg p-6" data-v0-t="card" style="width: 650px;">
                    <div class="flex flex-col space-y-1.5 p-6">
                        <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">Reviews</h3>
                    </div>

                    <div class="p-6">

                        <div class="grid gap-4">

                            <div class="relative w-full overflow-auto">
                                <table class="w-full caption-bottom text-sm">
                                    <thead class="[&amp;_tr]:border-b">
                                    <tr>
                                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                            No</th>
                                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                            Subject</th>
                                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                            Likecount</th>
                                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                            Doctor Name</th>
                                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                            Writeday</th>
                                        <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                            View</th>

                                    </tr>
                                    </thead>
                                    <tbody class="[&amp;_tr:last-child]:border-0">
                                    <tr th:each="item,itemStat:${list}" class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                                        <td th:text="${itemStat.count}"></td>
                                        <td>
                                            <form th:action="@{/reviewboard/detail}" method="post">
                                                <input type="hidden" name="review_no" th:value="${item.review_no}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"/>
                                                <input type="hidden" name="userId" th:value="${#authentication.name}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"/>
                                                <input type="hidden" name="currentPage" th:value="${currentpage}">
                                                <button type="submit" th:text="${item.review_title}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></button>
                                            </form>
                                        </td>
                                        <td><span class="reviewStarsBoard"></span>
                                            <script th:inline="javascript">
                                                let s = '';
                                                let ratings =/*[[${item.review_likecount}]]*/0;
                                                console.log(ratings);
                                                for (let i = 0; i < ratings; i++) {
                                                    s += `<span style="color: gold">&#9733</span>`;
                                                }
                                                for (let i = 0; i < ratings - 5; i++) {
                                                    s += `<span>&#9734;</span>`;
                                                }
                                                $(".reviewStarsBoard").html(s);
                                            </script></td>
                                        <td th:text="${item.employee_name}"></td>
                                        <td th:text="${item.getFormattedWriteday()}"></td>
                                        <td th:text="${item.review_viewcount}"></td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>


                <div class="bg-background rounded-lg shadow-lg p-6" data-v0-t="card" style="width: 650px;">
                    <div class="flex flex-col space-y-1.5 p-6">
                        <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">
                            Update Hospital Information
                        </h3>
                        <p class="text-sm text-muted-foreground">Modify your hospital's details and branding.</p>
                    </div>
                    <div class="p-6 grid gap-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="space-y-2" th:each="info:${emp_hos}">
                                <label
                                        class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                >
                                    Hospital Name
                                </label>
                                <div class="flex items-center gap-2">
                                    <h2 class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                        th:text="${info.info_name}"></h2>

                                </div>
                                </form>
                            </div>
                            <div class="space-y-2">
                                <form action="/registerHp" th:each="info:${emp_hos}" method="post">
                                <label
                                        class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                        for="hp"
                                >
                                    HP
                                </label>
                                <div class="flex items-center gap-2">
                                    <input
                                            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                            id="hp" name="hp" th:value="${info.info_hp}"
                                            type="tel"
                                    />
                                    <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                        <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2">
                                            Edit
                                        </button>
                                    </th:block>
                                </div>
                                </form>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <form action="/registerAddress" th:each="info:${emp_hos}" method="post">
                                <label
                                        class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                        for="address"
                                >
                                    Address
                                </label>
                                <div class="flex items-center gap-2"  style="width: 600px;">
                                <input
                                    class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                    id="address" name="address" th:value="${info.info_addr}"
                                        style="width: 100%;"
                                    />
                                    <button type="button" class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 rounded-md px-3 ml-2 bg-orange-600"
                                            onclick="">
                                        주소찾기
                                    </button>
                                    <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                        <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2">
                                            Edit
                                        </button>
                                    </th:block>
                                </div>
                                </form>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div class="space-y-2">
                                <form action="/registerPlus" th:each="info:${emp_hos}" method="post">
                                <label
                                        class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                        for="plus"
                                >
                                    Plus
                                </label>
                                <div class="flex items-center gap-2">
                                    <input
                                            class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                            id="plus" name="plus" th:value="${info.info_plus}"
                                    />
                                    <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                        <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2">
                                            Edit
                                        </button>
                                    </th:block>
                                </div>
                                </form>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <form action="/registerDescription" th:each="info:${emp_hos}" method="post">
                            <label
                                    class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                    for="description"
                            >
                                Description
                            </label>
                            <div class="flex items-center gap-2">
        <input
                class="flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 min-h-[100px]"
                id="description" name="description" th:value="${info.info_description}"
        />
                                <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                    <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2">
                                        Edit
                                    </button>
                                </th:block>
                            </div>
                            </form>
                        </div>
                        <div class="space-y-2">
                            <form action="/registerPhoto" th:each="info:${emp_hos}" method="post" enctype="multipart/form-data">
                            <label
                                    class="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
                                    for="photo"
                            >
                                Logo or Header Image
                            </label>
                            <div class="flex items-center gap-2">
                                <input
                                        class="flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"
                                        id="photo" name="photo" th:value="${info.info_photo}"
                                        type="file"
                                />
                                <th:block sec:authorize="hasAuthority('ROLE_MANAGER')">
                                    <button type="submit" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2">
                                        Edit
                                    </button>
                                </th:block>
                            </div>
                                <div >
                                    <img th:src="|https://miniodb.midichi.kro.kr/nangmandoctor/Hospital_Info/${info.info_photo}|" alt="Uploaded Photo"
                                    style="width: 100%;"/>
                                </div>
                            </form>

                        </div>
                    </div>
                </div>

                </div>
            <div class="grid gap-8" style="display: flex; margin: 10px;">
                <div class="bg-background rounded-lg shadow-lg p-6" data-v0-t="card">
                    <div class="flex flex-col space-y-1.5 p-6">
                        <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">Reservations</h3>
                    </div>
                    <div class="p-6">
                        <div class="relative w-full overflow-auto">
                            <table class="w-full caption-bottom text-sm">
                                <thead class="[&amp;_tr]:border-b">
                                <tr class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Customer
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Date
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Time
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Status
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Reason
                                    </th>
                                    <th class="h-12 px-4 text-left align-middle font-medium text-muted-foreground [&amp;:has([role=checkbox])]:pr-0">
                                        Content
                                    </th>
                                </tr>
                                </thead>
                                <tbody class="[&amp;_tr:last-child]:border-0">
                                <tr th:each="res: ${reservations}" th:if="${res.reservation_status} != 2" class="border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted">
                                    <td th:text="${res.reservation_no}" class="p-4 align-middle reservation-no [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${res.reservation_date}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td th:text="${res.reservation_time}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0"></td>
                                    <td class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0">
                                      <span th:if="${res.reservation_status} == 1">
                                            <div>
                                                    <button type="button" class="btn btn-success"
                                                            th:data-id="${res.reservation_no}"
                                                            th:onclick="'SendStatus(' + ${res.reservation_no} + ', true)'">
                                                        수락
                                                    </button>
                                                    <button type="button" class="btn btn-danger"
                                                            th:data-id="${res.reservation_no}"
                                                            th:onclick="'SendStatus(' + ${res.reservation_no} + ', false)'">
                                                        거절
                                                    </button>

                                            </div>
                                        </span>

                                        <!--<span th:if="${res.reservation_status} == 2">응답대기중</span>-->
                                    </td>
                                    <td th:text="${res.reservation_reason}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0 reservation-reason"></td>
                                    <td th:text="${res.reservation_content}" class="p-4 align-middle [&amp;:has([role=checkbox])]:pr-0 reservation-content"></td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="bg-background rounded-lg shadow-lg p-6" data-v0-t="card">
                    <div class="flex flex-col space-y-1.5 p-6">
                        <h3 class="whitespace-nowrap text-2xl font-semibold leading-none tracking-tight">Calendar</h3>
                    </div>
                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button onclick="navigateMonth(-1)">Previous</button>
                            <h2 id="currentMonthYear"></h2>
                            <button onclick="navigateMonth(1)">Next</button>
                        </div>
                        <table class="calendar-table">
                            <thead>
                            <tr>
                                <th>Su</th>
                                <th>Mo</th>
                                <th>Tu</th>
                                <th>We</th>
                                <th>Th</th>
                                <th>Fr</th>
                                <th>Sa</th>
                            </tr>
                            </thead>
                            <tbody id="calendarBody">
                            </tbody>
                        </table>
                    </div>

                    <script th:inline="javascript">
                        let reservations = /*[[${reservations}]]*/ [];
                        let currentMonth = new Date().getMonth();
                        let currentYear = new Date().getFullYear();

                        function renderCalendar(month, year) {
                            const monthNames = ["January", "February", "March", "April", "May", "June",
                                "July", "August", "September", "October", "November", "December"];
                            const firstDay = new Date(year, month).getDay();
                            const daysInMonth = new Date(year, month + 1, 0).getDate();

                            const calendarBody = document.getElementById("calendarBody");
                            const currentMonthYear = document.getElementById("currentMonthYear");
                            calendarBody.innerHTML = "";
                            currentMonthYear.innerText = `${monthNames[month]} ${year}`;

                            let date = 1;
                            for (let i = 0; i < 6; i++) {
                                const row = document.createElement("tr");
                                for (let j = 0; j < 7; j++) {
                                    const cell = document.createElement("td");
                                    const cellContent = document.createElement("div");
                                    cellContent.style.display = "flex";
                                    cellContent.style.flexDirection = "column";
                                    cellContent.style.alignItems = "center";

                                    if (i === 0 && j < firstDay) {
                                        cell.innerText = "";
                                    } else if (date > daysInMonth) {
                                        break;
                                    } else {
                                        const dateDiv = document.createElement("div");
                                        dateDiv.innerText = date;
                                        cellContent.appendChild(dateDiv);

                                        // Check for reservations on this date
                                        const reservation = reservations.find(res => {
                                            const resDate = new Date(res.reservation_date);
                                            return resDate.getDate() === date && resDate.getMonth() === month && resDate.getFullYear() === year && res.reservation_status === 2;
                                        });

                                        if (reservation) {
                                            if (reservation.reservation_face === 2) {
                                                const button = document.createElement("button");
                                                button.classList.add("video-call-button");
                                                button.innerText = "화상채팅";
                                                button.addEventListener("click", function() {
                                                    window.open('https://webchat.midichi.kro.kr/');
                                                    window.location.href = `/test?reservation_no=${reservation.reservation_no}`;
                                                });
                                                cellContent.appendChild(button);
                                            } else if (reservation.reservation_face === 1) {
                                                const text = document.createElement("span");
                                                text.classList.add("in-person-appointment");
                                                text.innerText = "대면 진료";
                                                text.style.backgroundColor = "yellow";
                                                text.style.padding = "0 5px";
                                                text.style.borderRadius = "3px";
                                                text.style.fontWeight = "bold";
                                                cellContent.appendChild(text);
                                            }
                                        }


                                        date++;
                                    }
                                    cell.appendChild(cellContent);
                                    row.appendChild(cell);
                                }
                                calendarBody.appendChild(row);
                            }
                        }

                        function navigateMonth(offset) {
                            currentMonth += offset;
                            if (currentMonth < 0) {
                                currentMonth = 11;
                                currentYear--;
                            } else if (currentMonth > 11) {
                                currentMonth = 0;
                                currentYear++;
                            }
                            renderCalendar(currentMonth, currentYear);
                        }

                        document.addEventListener("DOMContentLoaded", () => {
                            renderCalendar(currentMonth, currentYear);
                        });
                        function SendStatus(reservationNo, isAccepted) {
                            $.ajax({
                                url: '/SendStatus',
                                type: 'POST',
                                dataType: 'json',
                                data: {
                                    reservationNo: reservationNo,
                                    isAccepted: isAccepted
                                },
                                success: function(response) {
                                    if (response.status === "error") {
                                        console.error("Server Error: ", response.message);
                                        alert('Error handling reservation: ' + response.message);
                                    } else {

                                        // Update the reservation status in the table without refreshing the page
                                        let statusCell = $(`td:contains('${response.reservationNo}')`).siblings()[3]; // Assuming status is the 4th cell
                                        if (response.isAccepted === "true") {
                                            $(statusCell).text('Accepted');
                                            alert('예약이 수락되었습니다. 이메일이 발송될거에요!')
                                        } else {
                                            $(statusCell).text('Rejected');
                                            alert('예약이 거절되었습니다.')
                                        }

                                        // Optionally, you can remove the buttons after updating the status
                                        $(statusCell).find('button').remove();

                                        // Alternatively, you can refresh the page
                                        location.reload();
                                    }
                                },
                                error: function(xhr, status, error) {
                                    console.error("AJAX Error: ", status, error);
                                    console.error("Response Text: ", xhr.responseText);
                                    alert('Error handling reservation');
                                }
                            });
                        }



                    </script>

                </div>

            </div>
        </div>


                    </div>
                </div>

    </div>
</div>

</div>


</html>
